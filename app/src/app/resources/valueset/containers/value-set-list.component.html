<m-card>
  <div *m-card-header class="tw-card-header">
    <m-input [(ngModel)]="searchInput" (mChange)="searchUpdate.next($event)" placeholder="marina.ui.inputs.search.placeholder"></m-input>
    <m-button [routerLink]="'value-sets/add'">
      <m-icon [code]="'plus'"></m-icon> &nbsp; {{'web.value-set.form.add-header' | translate}}
    </m-button>
  </div>

  <!-- todo: m-backend-table -->
  <m-table [data]="searchResult.data"
      [loading]="loading"
      outlined
      enablePagination
      manualPagination
      [total]="searchResult.meta.total"
      [pageSize]="query.limit"
      [(pageIndex)]="query['page']"
      (pageIndexChange)="loadData()">
    <tr *mTableHead>
      <th></th>
      <th>{{'web.value-set.entity.id' | translate}}</th>
      <th>{{'web.value-set.entity.name' | translate}}</th>
      <th>{{'web.value-set.list.domain' | translate}}</th>
      <th class="tw-table-actions">{{'web.value-set.list.operations' | translate}}</th>
    </tr>

    <tr *mTableRow="let vs">
      <td m-table-expand [item]="vs"></td>
      <td><a [routerLink]="['value-sets',vs.id, 'edit']">{{vs.id}}</a></td>
      <td>{{vs.names | localName}}</td>
      <td>{{vs.uri | apply: parseDomain}}</td>
      <td class="tw-table-actions">
        <button nz-button nzType="primary" nzDanger>{{'core.btn.delete' | translate}}</button>
      </td>
    </tr>

    <tr *mTableRowExpand="let vs" class="m-table-expanded-row">
      <td colspan="5">
        <m-form-row full>
          <div *mFormCol>
            <m-form-item label="web.value-set.entity.uri">
              {{vs.uri}}
            </m-form-item>
            <m-form-item label="web.value-set.entity.description">
              {{vs.description}}
            </m-form-item>
            <m-form-item label="web.value-set.list.versions">
              <div *ngFor="let version of vs.versions">{{
                version | apply: getVersionTranslateTokens: ({
                  releaseDate: (version.releaseDate | localDate),
                  expirationDate: (version.expirationDate | localDate),
                  version: version.version
                }) | join: ' '}}
              </div>
            </m-form-item>
          </div>
        </m-form-row>
      </td>
    </tr>

    <tr *mTableNoData>
      <td colspan="5">
        <m-no-data></m-no-data>
      </td>
    </tr>
  </m-table>
</m-card>
